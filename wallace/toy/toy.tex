%*********************************************************************************************************************%
%                                                                                                                     %
%                                                    Wallace                                                          %
%                                                                                                                     %
%                               François Pottier, projet Cristal, INRIA Rocquencourt                                  %
%                                                                                                                     %
%    Copyright 2000 Institut National de Recherche en Informatique et Automatique. Distributed only by permission.    %
%                                                                                                                     %
%*********************************************************************************************************************%
% $Header: /home/pauillac/formel1/fpottier/cvs/toy/toy.tex,v 1.3 2000/02/11 16:16:35 fpottier Exp $

\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amstext}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{graphics}
\usepackage[latin1]{inputenc}
\usepackage{latexsym}
\usepackage[bypages,novisiblespaces]{ocamlweb}
\usepackage{stmaryrd}

\special{papersize=210mm,297mm}
\geometry{a4paper,body={5.6in,9in}}

\title{Toy}
\author{François Pottier}

% ---------------------------------------------------------------------------------------------------------------------
% Redefine ocamlweb's sectioning commands.
%
% Currently (as of version 0.6), ocamlweb gives satisfactory results, except it uses \section* instead of \section,
% which prevents the sections from showing up in the table of contents.

\renewcommand{\ocwmodule}[1]{\section{Module #1}}
\renewcommand{\ocwinterface}[1]{\section{Interface of module #1}}

% Define internal sectioning commands.

\newcommand{\mysection}[1]{\subsection{#1}}
\newcommand{\mysubsection}[1]{\subsubsection{#1}}

% ---------------------------------------------------------------------------------------------------------------------
% Some useful macros.

\newcommand{\norm}[1]{\mathord\mid\, #1\,\mathord\mid}
\newcommand{\ccc}[3]{#1\leq#2\,?\,#3}
\newcommand{\cc}[4]{\ccc{#1}{#2}{#3\leq#4}}
\newcommand{\urow}{\partial}
\newcommand{\encode}[1]{\llbracket#1\rrbracket}
\newcommand{\scheme}[3]{\forall#3.#1\Rightarrow#2}
\newcommand{\context}[1]{\langle#1\rangle}

% ---------------------------------------------------------------------------------------------------------------------

\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage

\section{Overview}

Toy is a type-checker for a small functional language, built using Wallace. The language has records, variants, and
supports a few advanced features, such as record update, extension, restriction, (symmetric and asymmetric)
concatenation, and ``dynamic message send'' (see \verb+builtin+'s definition, in module \verb+Engine+). Typing these
operations requires rows and conditional constraints.

The following picture gives an overview of Toy's organization:
%
$$\scalebox{.65}{\includegraphics*{map.ps}}$$
%
The blank node stands for Wallace. Module \verb+MlAlgebra+ defines the set of types to be used by Wallace. Its code is
generated by Gromit after the high-level description given in \verb+mlAlgebra.grm+. The two most important modules are
\verb+Compile+, which compiles the language's abstract syntax into a very restricted ``internal'' syntax, and
\verb+Engine+, which contains a type-checker for the internal syntax. Compiling \emph{before} type-checking allows
writing a very small type-checker, thus obtaining maximum flexibility when changes must be made. In a production
implementation, one might prefer to directly implement a type-checker for the input syntax, since that might be
slightly faster, and possibly safer.

\section{Limitations}

The language's syntax is entirely undocumented; please have a look at the parser (module \verb+ToyParser+).

The implementation is currently incomplete; in particular, it only accepts expressions, not toplevel definitions.

All \verb+let+ constructs are currently generalized, even in the presence of imperative constructs (which is unsound).

\input{toy-auto-generated}

\end{document}

